/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package athprod;

import DAO.daoFichas;
import DAO.daoempresa;
import DAO.daoserver;
import Modelo.Allsingleton;
import Modelo.Colores;
import Modelo.Corridas;
import Modelo.Departamentos_Prod;
import Modelo.DetFichas;
import Modelo.Empresas;
import Modelo.Fichas;
import Modelo.Hormas;
import Modelo.Linea;
import java.awt.Graphics2D;
import java.awt.Image;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;
import java.sql.Connection;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.imageio.ImageIO;
import javax.swing.DefaultListModel;
import javax.swing.ImageIcon;
import javax.swing.JDesktopPane;
import javax.swing.JDialog;
import javax.swing.JFileChooser;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.filechooser.FileNameExtensionFilter;
import javax.swing.table.DefaultTableModel;

/**
 *
 * @author GATEWAY1-
 */
public class Fichatecnica extends javax.swing.JInternalFrame {

    private JFileChooser filechooser = new JFileChooser();
    DefaultTableModel modeltabla;
    Allsingleton single = new Allsingleton();
    String imagen1 = "";
    String imagen2 = "";
    String imagen3 = "";
    String n1 = "";
    String n2 = "";
    String n3 = "";
    String buscar = "0";

    //Arraylist de objetos
    ArrayList<Colores> arrcolores = new ArrayList<>();
    ArrayList<Linea> arrlineas = new ArrayList<>();
    ArrayList<Hormas> arrhormas = new ArrayList<>();
    ArrayList<Departamentos_Prod> arrdeptos = new ArrayList<>();
    ArrayList<Corridas> arrcorridas = new ArrayList<>();
    ArrayList<DetFichas> df = new ArrayList<>();
    ArrayList<Fichas> arrfichas = new ArrayList<>();

    Connection con;

    /**
     * Creates new form Fichatecnica
     */
    public Fichatecnica() {
        initComponents();
        jMenu5.setVisible(false);
        Allsingleton.setDf(df);
        JcConfirma.setVisible(false);
        daoserver server = new daoserver();
        con = server.Getconexion();
        renuevatabla();
        cargacombos();

    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        Popficha = new javax.swing.JPopupMenu();
        JmEliminar = new javax.swing.JMenuItem();
        JmEditar = new javax.swing.JMenuItem();
        jPanel1 = new javax.swing.JPanel();
        JtBusca = new javax.swing.JTextField();
        jLabel15 = new javax.swing.JLabel();
        jScrollPane3 = new javax.swing.JScrollPane();
        Jlfichas = new javax.swing.JList<>();
        JcConfirma = new javax.swing.JCheckBox();
        jPanel2 = new javax.swing.JPanel();
        JImagen3 = new javax.swing.JLabel();
        Imagen = new javax.swing.JLabel();
        Imagen3 = new javax.swing.JLabel();
        Imagen2 = new javax.swing.JLabel();
        JbImagen2 = new javax.swing.JButton();
        JbImagen3 = new javax.swing.JButton();
        JbColor = new javax.swing.JComboBox<>();
        JbLinea = new javax.swing.JComboBox<>();
        JbHorma = new javax.swing.JComboBox<>();
        jLabel6 = new javax.swing.JLabel();
        JbCorrida = new javax.swing.JComboBox<>();
        jLabel7 = new javax.swing.JLabel();
        JbConstruccion = new javax.swing.JComboBox<>();
        jLabel8 = new javax.swing.JLabel();
        JtEstilo = new javax.swing.JTextField();
        jLabel9 = new javax.swing.JLabel();
        JtCode = new javax.swing.JTextField();
        jLabel10 = new javax.swing.JLabel();
        JtTipocalzado = new javax.swing.JTextField();
        jLabel11 = new javax.swing.JLabel();
        jLabel12 = new javax.swing.JLabel();
        jLabel13 = new javax.swing.JLabel();
        JbImagen = new javax.swing.JButton();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        Jlfecha = new javax.swing.JLabel();
        prueba = new javax.swing.JLabel();
        JImagen1 = new javax.swing.JLabel();
        JImagen2 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        jScrollPane4 = new javax.swing.JScrollPane();
        jPanel3 = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        JtFicha = new javax.swing.JTable();
        jScrollPane2 = new javax.swing.JScrollPane();
        JtComentario = new javax.swing.JTextArea();
        jLabel14 = new javax.swing.JLabel();
        jMenuBar1 = new javax.swing.JMenuBar();
        jMenu1 = new javax.swing.JMenu();
        jMenu2 = new javax.swing.JMenu();
        jMenu3 = new javax.swing.JMenu();
        jMenu4 = new javax.swing.JMenu();
        jMenu5 = new javax.swing.JMenu();

        JmEliminar.setText("Eliminar linea");
        JmEliminar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                JmEliminarActionPerformed(evt);
            }
        });
        Popficha.add(JmEliminar);

        JmEditar.setText("Editar Linea");
        JmEditar.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                JmEditarMousePressed(evt);
            }
        });
        JmEditar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                JmEditarActionPerformed(evt);
            }
        });
        Popficha.add(JmEditar);

        setClosable(true);
        setIconifiable(true);
        setMaximizable(true);
        setResizable(true);
        setTitle("Fichas Tecnicas");
        setAutoscrolls(true);
        setFrameIcon(new javax.swing.ImageIcon(getClass().getResource("/Recursos/1562683-branding-card-pencil-profile_107062.png"))); // NOI18N

        JtBusca.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                JtBuscaKeyReleased(evt);
            }
        });

        jLabel15.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Recursos/Magnifier_29783.png"))); // NOI18N

        Jlfichas.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                JlfichasMousePressed(evt);
            }
        });
        jScrollPane3.setViewportView(Jlfichas);

        JcConfirma.setFont(new java.awt.Font("Calibri", 0, 12)); // NOI18N
        JcConfirma.setText("Confirmar Ficha");
        JcConfirma.addChangeListener(new javax.swing.event.ChangeListener() {
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                JcConfirmaStateChanged(evt);
            }
        });
        JcConfirma.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                JcConfirmaActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(21, 21, 21)
                .addComponent(jLabel15)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(JtBusca, javax.swing.GroupLayout.PREFERRED_SIZE, 186, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(67, 67, 67)
                .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 372, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(JcConfirma)
                .addGap(27, 27, 27))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 62, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 4, Short.MAX_VALUE))
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(JtBusca)
                    .addComponent(jLabel15))
                .addGap(19, 19, 19))
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(18, 18, 18)
                .addComponent(JcConfirma)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        JImagen3.setFont(new java.awt.Font("Calibri", 0, 11)); // NOI18N

        JbImagen2.setText("...");
        JbImagen2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                JbImagen2ActionPerformed(evt);
            }
        });

        JbImagen3.setText("...");
        JbImagen3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                JbImagen3ActionPerformed(evt);
            }
        });

        JbColor.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                JbColorItemStateChanged(evt);
            }
        });

        jLabel6.setFont(new java.awt.Font("Calibri", 0, 11)); // NOI18N
        jLabel6.setText("CONSTRUCCIÓN");

        jLabel7.setFont(new java.awt.Font("Calibri", 0, 11)); // NOI18N
        jLabel7.setText("CORRIDA");

        jLabel8.setFont(new java.awt.Font("Calibri", 0, 11)); // NOI18N
        jLabel8.setText("FECHA REA");

        jLabel9.setFont(new java.awt.Font("Calibri", 0, 11)); // NOI18N
        jLabel9.setText("REVISO VoBo");

        JtCode.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                JtCodeActionPerformed(evt);
            }
        });

        jLabel10.setFont(new java.awt.Font("Calibri", 0, 11)); // NOI18N
        jLabel10.setText("TIPO CALZADO");

        jLabel11.setFont(new java.awt.Font("Calibri", 0, 11)); // NOI18N
        jLabel11.setText("IMAGEN 1");

        jLabel12.setFont(new java.awt.Font("Calibri", 0, 11)); // NOI18N
        jLabel12.setText("IMAGEN 2");

        jLabel13.setFont(new java.awt.Font("Calibri", 0, 11)); // NOI18N
        jLabel13.setText("IMAGEN 3");

        JbImagen.setText("...");
        JbImagen.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                JbImagenActionPerformed(evt);
            }
        });

        jLabel1.setFont(new java.awt.Font("Calibri", 0, 11)); // NOI18N
        jLabel1.setText("ESTILO");

        jLabel2.setFont(new java.awt.Font("Calibri", 0, 11)); // NOI18N
        jLabel2.setText("COLOR");

        jLabel3.setFont(new java.awt.Font("Calibri", 0, 11)); // NOI18N
        jLabel3.setText("CODE");

        jLabel4.setFont(new java.awt.Font("Calibri", 0, 11)); // NOI18N
        jLabel4.setText("LINEA");
        jLabel4.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                jLabel4MousePressed(evt);
            }
        });

        JImagen1.setFont(new java.awt.Font("Calibri", 0, 11)); // NOI18N

        JImagen2.setFont(new java.awt.Font("Calibri", 0, 11)); // NOI18N

        jLabel5.setFont(new java.awt.Font("Calibri", 0, 11)); // NOI18N
        jLabel5.setText("HORMA");

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel2)
                    .addComponent(jLabel1)
                    .addComponent(jLabel3)
                    .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(jPanel2Layout.createSequentialGroup()
                            .addComponent(jLabel4)
                            .addGap(29, 29, 29))
                        .addComponent(jLabel5, javax.swing.GroupLayout.Alignment.TRAILING)))
                .addGap(9, 9, 9)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGap(1, 1, 1)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(JbLinea, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(JbHorma, javax.swing.GroupLayout.PREFERRED_SIZE, 87, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(98, 98, 98)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel6)
                            .addComponent(jLabel9)
                            .addComponent(jLabel8)
                            .addComponent(jLabel7)
                            .addComponent(jLabel10)))
                    .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                        .addComponent(JtCode, javax.swing.GroupLayout.Alignment.TRAILING)
                        .addComponent(JbColor, javax.swing.GroupLayout.Alignment.TRAILING, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(JtEstilo, javax.swing.GroupLayout.PREFERRED_SIZE, 87, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGap(18, 18, 18)
                        .addComponent(JbConstruccion, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGap(17, 17, 17)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(JbCorrida, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(JtTipocalzado)
                            .addComponent(Jlfecha, javax.swing.GroupLayout.PREFERRED_SIZE, 85, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(prueba, javax.swing.GroupLayout.PREFERRED_SIZE, 93, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addGap(90, 90, 90)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addComponent(jLabel11)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(JbImagen, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                                    .addComponent(jLabel12)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                    .addComponent(JbImagen2, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                                    .addComponent(jLabel13)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                    .addComponent(JbImagen3, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE))))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(JImagen2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(JImagen1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(JImagen3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGap(46, 46, 46)
                        .addComponent(Imagen, javax.swing.GroupLayout.PREFERRED_SIZE, 75, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(Imagen2, javax.swing.GroupLayout.PREFERRED_SIZE, 75, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(Imagen3, javax.swing.GroupLayout.PREFERRED_SIZE, 75, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap())
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jLabel11)
                                    .addComponent(JbImagen, javax.swing.GroupLayout.PREFERRED_SIZE, 19, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE, false)
                                    .addComponent(jLabel12, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                    .addComponent(JbImagen2, javax.swing.GroupLayout.PREFERRED_SIZE, 19, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE, false)
                                    .addComponent(jLabel13, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                    .addComponent(JbImagen3, javax.swing.GroupLayout.PREFERRED_SIZE, 19, javax.swing.GroupLayout.PREFERRED_SIZE)))
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addComponent(JImagen1, javax.swing.GroupLayout.PREFERRED_SIZE, 19, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(JImagen2, javax.swing.GroupLayout.PREFERRED_SIZE, 19, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(JImagen3, javax.swing.GroupLayout.PREFERRED_SIZE, 19, javax.swing.GroupLayout.PREFERRED_SIZE)))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(Imagen3, javax.swing.GroupLayout.PREFERRED_SIZE, 76, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(Imagen, javax.swing.GroupLayout.PREFERRED_SIZE, 76, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(Imagen2, javax.swing.GroupLayout.PREFERRED_SIZE, 76, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGap(18, 18, 18)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel1)
                            .addComponent(jLabel6)
                            .addComponent(JbConstruccion, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(JtEstilo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel2)
                            .addComponent(jLabel7)
                            .addComponent(JbColor, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(JbCorrida, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(Jlfecha, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(jLabel3)
                                .addComponent(jLabel8)
                                .addComponent(JtCode, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addGap(45, 45, 45)
                                .addComponent(jLabel5))
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(JbLinea, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addGroup(jPanel2Layout.createSequentialGroup()
                                        .addGap(35, 35, 35)
                                        .addComponent(JbHorma, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                                    .addGroup(jPanel2Layout.createSequentialGroup()
                                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(prueba, javax.swing.GroupLayout.PREFERRED_SIZE, 19, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                                .addComponent(jLabel4)
                                                .addComponent(jLabel9)))
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                            .addComponent(jLabel10)
                                            .addComponent(JtTipocalzado, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))))))))
                .addGap(0, 8, Short.MAX_VALUE))
        );

        JtFicha.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {

            }
        ));
        JtFicha.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                JtFichaMousePressed(evt);
            }
        });
        jScrollPane1.setViewportView(JtFicha);

        JtComentario.setColumns(20);
        JtComentario.setFont(new java.awt.Font("Calibri", 1, 14)); // NOI18N
        JtComentario.setRows(3);
        JtComentario.setToolTipText("Observaciones");
        JtComentario.setCursor(new java.awt.Cursor(java.awt.Cursor.TEXT_CURSOR));
        JtComentario.setDragEnabled(true);
        jScrollPane2.setViewportView(JtComentario);

        jLabel14.setFont(new java.awt.Font("Calibri", 1, 12)); // NOI18N
        jLabel14.setText("OBSERVACIONES");

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addComponent(jLabel14)
                .addGap(0, 0, Short.MAX_VALUE))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel3Layout.createSequentialGroup()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 837, Short.MAX_VALUE)
                    .addComponent(jScrollPane2, javax.swing.GroupLayout.Alignment.TRAILING))
                .addContainerGap())
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 275, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(jLabel14)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(83, Short.MAX_VALUE))
        );

        jScrollPane4.setViewportView(jPanel3);

        jMenu1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Recursos/Save_as-80_icon-icons.com_57275.png"))); // NOI18N
        jMenu1.setToolTipText("Guardar Ficha Tecnica");
        jMenu1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                jMenu1MousePressed(evt);
            }
        });
        jMenuBar1.add(jMenu1);

        jMenu2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Recursos/1486485588-add-create-new-math-sign-cross-plus_81186.png"))); // NOI18N
        jMenu2.setToolTipText("Nuevo material a ficha tecnica");
        jMenu2.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                jMenu2MousePressed(evt);
            }
        });
        jMenu2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenu2ActionPerformed(evt);
            }
        });
        jMenuBar1.add(jMenu2);

        jMenu3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Recursos/Refresh_36729.png"))); // NOI18N
        jMenu3.setToolTipText("Actualizar tabla de Ficha tecnica");
        jMenu3.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                jMenu3MousePressed(evt);
            }
        });
        jMenuBar1.add(jMenu3);

        jMenu4.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Recursos/Clear_37294.png"))); // NOI18N
        jMenu4.setToolTipText("Limpia Campos");
        jMenu4.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                jMenu4MousePressed(evt);
            }
        });
        jMenuBar1.add(jMenu4);

        jMenu5.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Recursos/file_pdf_download_icon-icons.com_68954.png"))); // NOI18N
        jMenuBar1.add(jMenu5);

        setJMenuBar(jMenuBar1);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane4, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 394, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void JbImagenActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_JbImagenActionPerformed
        imagen1 = imagen(Imagen, JImagen1, "1");
    }//GEN-LAST:event_JbImagenActionPerformed

    private void JbImagen2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_JbImagen2ActionPerformed
        imagen2 = imagen(Imagen2, JImagen2, "2");
    }//GEN-LAST:event_JbImagen2ActionPerformed

    private void JbImagen3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_JbImagen3ActionPerformed
        imagen3 = imagen(Imagen3, JImagen3, "3");
    }//GEN-LAST:event_JbImagen3ActionPerformed

    private void JtCodeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_JtCodeActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_JtCodeActionPerformed

    private void JbColorItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_JbColorItemStateChanged
        int row = JbColor.getSelectedIndex();
//        System.out.println(arrcolores.get(row).getDescripcion() + " , " + arrcolores.get(row).getId_color());
    }//GEN-LAST:event_JbColorItemStateChanged

    private void jMenu2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenu2ActionPerformed

    }//GEN-LAST:event_jMenu2ActionPerformed

    private void jMenu2MousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jMenu2MousePressed
        ModFicha mficha = new ModFicha(null, true);
        mficha.setVisible(true);
        mficha.setAlwaysOnTop(true);
        mficha.setDefaultCloseOperation(JDialog.DISPOSE_ON_CLOSE);
        actualizatabla();

    }//GEN-LAST:event_jMenu2MousePressed

    private void jMenu3MousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jMenu3MousePressed

        if (Allsingleton.getDf().isEmpty()) {
            JOptionPane.showMessageDialog(null, "No hay Contenido dentro de la ficha, intente añadir mas en el simbolo +");
        } else {
            actualizatabla();
        }
    }//GEN-LAST:event_jMenu3MousePressed

    private void actualizatabla() {
        renuevatabla();
        modeltabla.setNumRows(Allsingleton.getDf().size());
        //System.out.println("size " + Allsingleton.getDf().size());
        for (int i = 0; i < Allsingleton.getDf().size(); i++) {
            modeltabla.setValueAt(Allsingleton.getDf().get(i).getTipomdesc(), i, 0);
            modeltabla.setValueAt(Allsingleton.getDf().get(i).getPiezadesc(), i, 1);
            modeltabla.setValueAt(Allsingleton.getDf().get(i).getMaterialdesc(), i, 2);
            modeltabla.setValueAt(Allsingleton.getDf().get(i).getColordesc(), i, 3);
            modeltabla.setValueAt(Allsingleton.getDf().get(i).getPzaxpar(), i, 4);
            modeltabla.setValueAt(Allsingleton.getDf().get(i).getConsumo(), i, 5);
            modeltabla.setValueAt(Allsingleton.getDf().get(i).getObservaciones(), i, 6);
            modeltabla.setValueAt(Allsingleton.getDf().get(i).getTotal(), i, 7);
            modeltabla.setValueAt(Allsingleton.getDf().get(i).getUnidad(), i, 8);
        }
    }

    private void JtFichaMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_JtFichaMousePressed
        //System.out.println(evt.getButton());
        if (evt.getButton() == 3) {
            Popficha.show(evt.getComponent(), evt.getX(), evt.getY());
        }
    }//GEN-LAST:event_JtFichaMousePressed

    private void JmEliminarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_JmEliminarActionPerformed
        eliminarlinea();
    }//GEN-LAST:event_JmEliminarActionPerformed

    private void jMenu1MousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jMenu1MousePressed
        nuevaficha();
    }//GEN-LAST:event_jMenu1MousePressed

    private void JmEditarMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_JmEditarMousePressed
        ModFicha mficha = new ModFicha(null, true);
        int rowficha = Jlfichas.getSelectedIndex();
        int row = JtFicha.getSelectedRow();
//        mficha.detfic = Allsingleton.getDf().get(row);
        mficha.detfic=arrfichas.get(rowficha).getArr().get(row);
        mficha.info = "2";
        mficha.mod = "2";
        mficha.ms();
        mficha.fi = arrfichas.get(rowficha);
        mficha.setVisible(true);
        mficha.setAlwaysOnTop(true);
        mficha.setDefaultCloseOperation(JDialog.DISPOSE_ON_CLOSE);
        actualizatabla();
    }//GEN-LAST:event_JmEditarMousePressed

    private void JmEditarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_JmEditarActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_JmEditarActionPerformed

    private void JtBuscaKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_JtBuscaKeyReleased
        DefaultListModel<String> modeloListaMat = new DefaultListModel<>();

        daoFichas dficha = new daoFichas();
        arrfichas = dficha.arrfichas(con, JtBusca.getText());
        for (int i = 0; i < arrfichas.size(); i++) {
            String estilo = arrfichas.get(i).getEstilo() + " - " + arrfichas.get(i).getDesccolor()
                    + " - " + arrfichas.get(i).getDesclinea() + " - " + arrfichas.get(i).getDescorrida();
            modeloListaMat.addElement(estilo);
        }

        Jlfichas.setModel(modeloListaMat);
    }//GEN-LAST:event_JtBuscaKeyReleased

    private void JlfichasMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_JlfichasMousePressed
        setficha();
        jMenu5.setVisible(true);
    }//GEN-LAST:event_JlfichasMousePressed

    private void jMenu4MousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jMenu4MousePressed
        limpiacampos();
        renuevatabla();
        cargacombos();
        jMenu5.setVisible(false);
        
        
    }//GEN-LAST:event_jMenu4MousePressed

    private void jLabel4MousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jLabel4MousePressed
        try {
            ImageIcon pica = new ImageIcon();
            Imagen.setIcon(pica);
            Imagen2.setIcon(pica);
            Imagen3.setIcon(pica);
        } catch (Exception ex) {
            Logger.getLogger(Fichatecnica.class.getName()).log(Level.SEVERE, null, ex);
        }

    }//GEN-LAST:event_jLabel4MousePressed

    private void JcConfirmaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_JcConfirmaActionPerformed

        daoFichas dff = new daoFichas();
        Fichas f = new Fichas();
        Calendar fecha = Calendar.getInstance();
        int row = Jlfichas.getSelectedIndex();
        int year = fecha.get(Calendar.YEAR);
        int mes = fecha.get(Calendar.MONTH) + 1;
        int dia = fecha.get(Calendar.DAY_OF_MONTH);
        int hr = fecha.get(Calendar.HOUR_OF_DAY);
        int min = fecha.get(Calendar.MINUTE);
        Jlfecha.setText(year + "-" + mes + "-" + dia);
        //fecha: dia-mes-año hr-min:00.000
        String lfecha = dia + "-" + mes + "-" + year + " " + hr + ":" + min + ":00.000";
        f.setFicha(arrfichas.get(row).getFicha());
        f.setFechaaprobado(lfecha);
        f.setDescusuario("Michel");

        dff.statusupdate(con, f);
        limpiacampos();
    }//GEN-LAST:event_JcConfirmaActionPerformed

    private void JcConfirmaStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_JcConfirmaStateChanged

    }//GEN-LAST:event_JcConfirmaStateChanged

    public void setficha() {
        int row = Jlfichas.getSelectedIndex();
        arrfichas.get(row).getConstruccion();
        arrfichas.get(row).getDesccolor();
        arrfichas.get(row).getDesclinea();
        arrfichas.get(row).getDescorrida();
        arrfichas.get(row).getDeschorma();
        JtEstilo.setText(arrfichas.get(row).getEstilo());
        JtCode.setText(arrfichas.get(row).getCode());
        JtTipocalzado.setText(arrfichas.get(row).getTipo_calzado());
        JbColor.setSelectedIndex(WIDTH);
        for (int i = 0; i < arrcolores.size(); i++) {
            if (arrfichas.get(row).getId_color() == arrcolores.get(i).getId_color()) {
                JbColor.setSelectedIndex(i);
            }
        }
        for (int i = 0; i < arrlineas.size(); i++) {
            if (arrfichas.get(row).getId_linea() == arrlineas.get(i).getLinea()) {
                JbLinea.setSelectedIndex(i);
            }
        }
        for (int i = 0; i < arrhormas.size(); i++) {
            if (arrfichas.get(row).getId_horma() == arrhormas.get(i).getHorma()) {
                JbHorma.setSelectedIndex(i);
            }
        }
        for (int i = 0; i < arrdeptos.size(); i++) {
            if (arrfichas.get(row).getConstruccion().equals(arrdeptos.get(i).getDescripcion())) {
                JbConstruccion.setSelectedIndex(i);
            }
        }
        for (int i = 0; i < arrcorridas.size(); i++) {
            if (arrfichas.get(row).getId_corrida() == arrcorridas.get(i).getCorrida()) {
                JbCorrida.setSelectedIndex(i);
            }
        }
        Allsingleton.setDf(arrfichas.get(row).getArr());
        actualizatabla();
        imagenm(Imagen, arrfichas.get(row).getImagen1(), "1");
        imagenm(Imagen2, arrfichas.get(row).getImagen2(), "2");
        imagenm(Imagen3, arrfichas.get(row).getImagen3(), "3");
        if (arrfichas.get(row).getEstatus_ok().equals("0")) {
            JcConfirma.setVisible(true);
            JcConfirma.setEnabled(true);
        } else if (arrfichas.get(row).getEstatus_ok().equals("2")) {
            //JcConfirma.setVisible(true);
            JcConfirma.setEnabled(false);
        } else if(arrfichas.get(row).getEstatus_ok().equals("1")){
             JcConfirma.setEnabled(false);
        }
    }

    //insercion de nueva ficha tecnica
    private void nuevaficha() {
        if (Allsingleton.getDf().isEmpty()) {
            JOptionPane.showMessageDialog(null, "No hay materiales dentro de la ficha tecnica, intente agregar algunos");
            jMenu2.requestFocus();
        } else {
            Fichas f = new Fichas();
            Calendar fecha = Calendar.getInstance();
            int year = fecha.get(Calendar.YEAR);
            int mes = fecha.get(Calendar.MONTH) + 1;
            int dia = fecha.get(Calendar.DAY_OF_MONTH);
            int hr = fecha.get(Calendar.HOUR_OF_DAY);
            int min = fecha.get(Calendar.MINUTE);
            Jlfecha.setText(year + "-" + mes + "-" + dia);
            //fecha: dia-mes-año hr-min:00.000
            String lfecha = dia + "-" + mes + "-" + year + " " + hr + ":" + min + ":00.000";
            f.setEstilo(JtEstilo.getText().toUpperCase());
            f.setCode(JtCode.getText().toUpperCase());
            f.setNombre("");
            f.setNombre1("");
            f.setTipo_calzado(JtTipocalzado.getText().toUpperCase());
            f.setFecharea(lfecha);
            f.setFecharev(null);
            f.setReviso_bobo("");
            f.setImagen1(imagen1);//a la base de datos
            f.setImagen2(imagen2);
            f.setImagen3(imagen3);
            f.setNombreimagen1(n1);//nombre de 
            f.setNombreimagen2(n2);
            f.setNombreimagen3(n3);
            f.setUrl1(imagen1);//url base de copia
            f.setUrl2(imagen2);
            f.setUrl3(imagen3);
            f.setConstruccion(arrdeptos.get(JbConstruccion.getSelectedIndex()).getDescripcion());
            f.setObservaciones(JtComentario.getText().toUpperCase());
            f.setId_corrida(arrcorridas.get(JbCorrida.getSelectedIndex()).getCorrida());
            f.setEstatus_ok("0");
            f.setFechaaprobado(lfecha);
            f.setReviso_bobo("");
            f.setId_usuario(1);
            f.setId_linea(arrlineas.get(JbLinea.getSelectedIndex()).getLinea());
            f.setId_horma(arrhormas.get(JbHorma.getSelectedIndex()).getHorma());
            f.setId_color(arrcolores.get(JbColor.getSelectedIndex()).getId_color());
            f.setDesccolor(arrcolores.get(JbColor.getSelectedIndex()).getDescripcion());
            f.setEstatus("1");
            f.setArr(Allsingleton.getDf());//arraylist de contenido
            daoFichas dff = new daoFichas();
            if (dff.chekficha(con, f)) {
                JOptionPane.showMessageDialog(null, "Los datos de estilo con sus caracteristicas ya existen");
            } else {
                daoempresa de = new daoempresa();
                Empresas emp = de.getempresa(con);
                String carpeta = f.getEstilo() + f.getId_corrida() + f.getId_linea() + f.getId_horma() + f.getId_color();
                f.setImagen1(emp.getDirimag() + "\\" + carpeta + "\\" + n1);
                f.setImagen2(emp.getDirimag() + "\\" + carpeta + "\\" + n2);
                f.setImagen3(emp.getDirimag() + "\\" + carpeta + "\\" + n3);
                if (dff.nuevaficha(con, f)) {
                    limpiacampos();
                    actualizatabla();
                    cargacombos();
                    JOptionPane.showMessageDialog(null, "Completo");
                    copyfile(f, emp.getDirimag(), carpeta);
                } else {
                    JOptionPane.showMessageDialog(null, "Error");
                }
            }

        }
    }

    private void copyfile(Fichas f, String url, String c) {
        try {
            String cmd = "mkdir " + url + "\\" + c;//Crear carpeta 
            Runtime.getRuntime().exec(cmd);
            cmd = "cp " + f.getUrl1() + " " + url + "\\" + c + "\\" + f.getNombreimagen1();//copiar archivo de url de pc
            Runtime.getRuntime().exec(cmd);
            cmd = "cp " + f.getUrl2() + " " + url + "\\" + c + "\\" + f.getNombreimagen2();//copiar archivo de url de pc
            Runtime.getRuntime().exec(cmd);
            cmd = "cp " + f.getUrl3() + " " + url + "\\" + c + "\\" + f.getNombreimagen3();//copiar archivo de url de pc
            Runtime.getRuntime().exec(cmd);
            System.out.println(cmd);
        } catch (IOException ex) {
            Logger.getLogger(Fichatecnica.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    private void eliminarlinea() {
        int row = JtFicha.getSelectedRow();
        Allsingleton.getDf().remove(row);
        actualizatabla();
    }

    private String imagen(JLabel imag, JLabel ruta, String nombre) {
        String archivo = "";
        filechooser.setFileSelectionMode(JFileChooser.FILES_ONLY);
        filechooser.addChoosableFileFilter(new FileNameExtensionFilter("Images(jpg,png,bmp,gif)", "jpg", "png", "bmp", "gif"));
        filechooser.setAcceptAllFileFilterUsed(true);
        int returnval = filechooser.showOpenDialog(this);
        if (returnval == JFileChooser.APPROVE_OPTION) {
            try {
                File file = filechooser.getSelectedFile();
                ruta.setText(file.getAbsolutePath());
                BufferedImage bimage = ImageIO.read(file);
                Image pic = bimage.getScaledInstance(75, 75, Image.SCALE_DEFAULT);
                ImageIcon pica = new ImageIcon(pic);
                imag.setIcon(pica);
                archivo = file.getAbsolutePath();
                if (nombre.equals("1")) {
                    n1 = file.getName();
                } else if (nombre.equals("2")) {
                    n2 = file.getName();
                } else {
                    n3 = file.getName();
                }
                //prueba.setText(file.getName());
            } catch (IOException ex) {
                Logger.getLogger(Fichatecnica.class.getName()).log(Level.SEVERE, null, ex);
            }
        } else {
        }
        return archivo;
    }

    private String imagenm(JLabel imag, String ruta, String nombre) {
        String archivo = "";
        try {
            File file = new File(ruta);
            BufferedImage bimage = ImageIO.read(file);
            Image pic = bimage.getScaledInstance(75, 75, Image.SCALE_DEFAULT);
            ImageIcon pica = new ImageIcon(pic);
            imag.setIcon(pica);
            if (nombre.equals("1")) {
                n1 = file.getName();
            } else if (nombre.equals("2")) {
                n2 = file.getName();
            } else {
                n3 = file.getName();
            }
            //prueba.setText(file.getName());
        } catch (IOException ex) {
            Logger.getLogger(Fichatecnica.class.getName()).log(Level.SEVERE, null, ex);
        }

        return archivo;
    }

    private void renuevatabla() {
        modeltabla = new DefaultTableModel();
        modeltabla.addColumn("TIPO");
        modeltabla.addColumn("PIEZA");
        modeltabla.addColumn("MATERIAL");
        modeltabla.addColumn("COLOR");
        modeltabla.addColumn("PZS X PAR");
        modeltabla.addColumn("CONSUMO");
        modeltabla.addColumn("OBSERVACIONES");
        modeltabla.addColumn("TOTAL");
        modeltabla.addColumn("UNIDAD");
        JtFicha.setModel(modeltabla);
    }

    private void limpiacampos() {
        JtEstilo.setText("");
        JtCode.setText("");
        JtComentario.setText("");
        JImagen1.setText("");
        JImagen2.setText("");
        JImagen3.setText("");
        Imagen.setText("");
        Imagen2.setText("");
        Imagen3.setText("");
        JtTipocalzado.setText("");
        Allsingleton.getDf().clear();
        buscar = "0";
        ImageIcon pica = new ImageIcon();
        Imagen.setIcon(pica);
        Imagen2.setIcon(pica);
        Imagen3.setIcon(pica);
    }

    private void cargacombos() {

        daoFichas dficha = new daoFichas();
        arrcolores = dficha.getcolores(con);
        arrlineas = dficha.getLineas(con);
        arrhormas = dficha.gethormas(con);
        arrcorridas = dficha.getcorridas(con);
        arrdeptos = dficha.detdepprods(con);
        llenacombos();
    }

    private void llenacombos() {
        if (arrcolores.isEmpty() || arrlineas.isEmpty() || arrhormas.isEmpty()
                || arrcorridas.isEmpty() || arrdeptos.isEmpty()) {
            JOptionPane.showMessageDialog(null, "Falta informacion necesaria "
                    + "por llenar, verifica los COLORES, LINEAS, HORMAS, CORRIDAS Y DEPARTAMENTOS DE PRODUCCION");
        } else {
            for (int i = 0; i < arrcolores.size(); i++) {
                JbColor.addItem(arrcolores.get(i).getDescripcion());
            }
            for (int i = 0; i < arrlineas.size(); i++) {
                JbLinea.addItem(arrlineas.get(i).getDescripcion());
            }
            for (int i = 0; i < arrhormas.size(); i++) {
                JbHorma.addItem(arrhormas.get(i).getDescripcion());
            }
            for (int i = 0; i < arrcorridas.size(); i++) {
                JbCorrida.addItem(arrcorridas.get(i).getDescripcion());
            }
            for (int i = 0; i < arrdeptos.size(); i++) {
                JbConstruccion.addItem(arrdeptos.get(i).getDescripcion());
            }
        }
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JLabel Imagen;
    private javax.swing.JLabel Imagen2;
    private javax.swing.JLabel Imagen3;
    private javax.swing.JLabel JImagen1;
    private javax.swing.JLabel JImagen2;
    private javax.swing.JLabel JImagen3;
    private javax.swing.JComboBox<String> JbColor;
    private javax.swing.JComboBox<String> JbConstruccion;
    private javax.swing.JComboBox<String> JbCorrida;
    private javax.swing.JComboBox<String> JbHorma;
    private javax.swing.JButton JbImagen;
    private javax.swing.JButton JbImagen2;
    private javax.swing.JButton JbImagen3;
    private javax.swing.JComboBox<String> JbLinea;
    private javax.swing.JCheckBox JcConfirma;
    private javax.swing.JLabel Jlfecha;
    private javax.swing.JList<String> Jlfichas;
    private javax.swing.JMenuItem JmEditar;
    private javax.swing.JMenuItem JmEliminar;
    private javax.swing.JTextField JtBusca;
    private javax.swing.JTextField JtCode;
    private javax.swing.JTextArea JtComentario;
    private javax.swing.JTextField JtEstilo;
    private javax.swing.JTable JtFicha;
    private javax.swing.JTextField JtTipocalzado;
    private javax.swing.JPopupMenu Popficha;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JMenu jMenu1;
    private javax.swing.JMenu jMenu2;
    private javax.swing.JMenu jMenu3;
    private javax.swing.JMenu jMenu4;
    private javax.swing.JMenu jMenu5;
    private javax.swing.JMenuBar jMenuBar1;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JLabel prueba;
    // End of variables declaration//GEN-END:variables
}
